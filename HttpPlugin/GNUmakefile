TARGET_OBJ  = HttpPlugin
TEMPLATE    = shlib

DEPEND_DIRS = Primitives/Logging Primitives/CorbaHelpers \
              CIS/HttpServer CIS/InfraServer_IDL \
              Notification/NotificationService_IDL \
              Notification/CommonNotificationCpp \
              mmss/MMServer mmss/MMClient Notification/ORM_IDL \
              mmss/ONVIFServer \
              Primitives/Crypto \
              CIS/SecurityManager \
              vmda \
              BL/BL_IDL CIS/SecurityManager/client \
              Primitives/GrpcHelpers \
              BL/NativeBLClient \
              BL/bl.grpc.proto \
              mmss/HeatMap


INCLUDE_PATH = Primitives CIS mmss mmss/HttpPlugin Notification vmda BL BL/bl.grpc.proto mmss/ONVIFServer mmss/ONVIFServer/onvifserverlib mmss/ONVIFServer/onvifserverlib/AutoGenerated
DEFINITIONS = HTTPPLUGIN_EXPORTS BOOST_NETWORK_ENABLE_HTTPS BOOST_COROUTINES_NO_DEPRECATION_WARNING

INT_LIBS = Logging CorbaHelpers HTTPServer MMCoding MMClient MMServer MMSS \
           MMIDL MMTransport MMExport SecurityManagerClient \
           Crypto \
           SecurityManager \
           vmda \
           CommonNotificationCpp \
           Notification_IDL InfraServer_IDL ORM_IDL BL_IDL NotificationService InfraServer \
           ONVIFServer \
           HttpClient \
           CloudUtils \
           ConsulUtils \
           blgrpcproto \
           GrpcHelpers \
           NativeBLClient \
           HeatMap \
           ChaosMonkey

EXT_LIBS = $(TAO_COMMON_LIBS) TAO_CosNaming TAO_CosTrading \
           $(AVFORMAT) $(AVCODEC) $(AVUTIL) \
           cppnetlib-uri cppnetlib-client-connections \
           ssl \
           crypto \
           xerces-c \
           gstaudio-1.0 gstreamer-1.0 gobject-2.0 glib-2.0 gstrtsp-1.0 gstrtp-1.0 gstrtspserver-1.0 \
           fmt dl jsoncpp

BOOST_LIBS = $(BOOST_SERIALIZATION_LIBS) regex date_time system thread filesystem program_options locale

OBJECTS = AlertsHandler \
          ArchivePlugin \
          ArchivePluginBookmarks \
          ArchiveListPlugin \
          BLQueryHelper \
          ../../CIS/HttpServer/BasicServlet \
          CloudPlugin \
          CommonPlugin  \
          CommonUtility \
          CommonUtilityDetectors \
          ConfigHelper  \
          Constants     \
          DataSink      \
          DetectorsHandler \
          GroupPlugin \
          GstreamerMuxer \
          HostPlugin    \
          ../../CIS/HttpServer/json_oarchive \
          LivePlugin    \
          LiveSnapshotServlet \
          OrmPlugin     \
          ProxyServlet \
          RedirectionServlet \
          RegexUtility  \
          SearchPlugin  \
          SearchPluginAuto \
          SearchPluginFace \
          SearchPluginVmda \
          SearchPluginHeatMap \
          SearchPluginStranger \
          FaceRatingPlugin \
          SendContext   \
          Service       \
          Statistics    \
          StatisticsCache \
          TelemetryPlugin \
          Tokens        \
          Hls \
          UrlBuilder \
          ExportPlugin \
          MacroPlugin \
          VideoAPServlet \
          VideoSourceCache \
          DetectorPlugin \
          ConnectionPolicyInterceptor \
          AuditPlugin \
          GstreamerMeta \
          GstreamerManager \
          GstreamerRTSP \
          WebSocket \
          LayoutPlugin \
          GrpcHelpers \
          GrpcPlugin \
          CameraPlugin \
          RightsChecker \
          TrustedIpList \
          EventStream \
          ArchiveHealthPlugin \
          ArchiveCalendarPlugin \
          CameraEventPlugin \
          WebSocketSession \
          RightsInterceptor \
          BearerAuthInterceptor \
          DiscoverCamerasPlugin \
          GrpcWebProxyGoManager \
          DataBuffer \
          MMCache \
          UriCodec \
          MetaCredentialsStorage

CXXFLAGS = -Werror -Wno-misleading-indentation

#
# include sources generated by ProtoProcessor
#
PROTOPROC_INPUT_DIR = $(NGP_ROOT)/BL/bl.grpc.proto/protos
PROTOPROC_SOURCES = \
    AcfaService \
    Audit \
    ArchiveSupport \
    ArchiveVolumeService \
    Authentication \
    BackupSource \
    Cloud \
    ConfigurationService \
    ConfigurationManager \
	DynamicParametersService \
    DevicesCatalog \
    Discovery \
    Domain \
    Domain.Internal \
    DomainManager \
    EventHistory \
    ExportService \
    EMailNotifier \
    FileSystemBrowser \
    GroupManager \
    HeatMap \
    LayoutManager \
    LicenseService \
    LogicService \
    MapService \
    Notification \
    Notification.Internal \
    RealtimeRecognizer \
    SecurityService \
    GSMNotifier \
    StateControl \
    Statistics \
    TagAndTrack \
    Telemetry \
    TimeZonesManager \
    Videowall \
    VMDA

#
# Unit tests
#

UT_DEFINITIONS = BOOST_NETWORK_ENABLE_HTTPS BOOST_COROUTINES_NO_DEPRECATION_WARNING
UT_LINK_WITH_TARGET_STATICALLY := 1
UT_OBJECTS = tests/TestGetParam tests/TestGStreamer tests/TestRegexUtility tests/TestTokens tests/TestUtils tests/TestHttpParsingHelper
UT_INCLUDE_PATH := $(INCLUDE_PATH)

include ../ProtoProcessor/protoproc-pre.mk
include ../../Makefile.common
include ../ProtoProcessor/protoproc-post.mk
